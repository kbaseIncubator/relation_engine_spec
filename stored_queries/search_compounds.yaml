# Use ArangoSearch to search documents in the compounds index. Returns documents by ascending id.
name: search_compounds
params:
  type: object
  properties:
    search_text:
      type: string
    all_documents:
      type: boolean
      description: Ignore search text and return all documents
    include_obsolete:
      type: boolean
      description: should obsolete documents be included?
    offset:
      type: integer
      description: how many documents to skip
    result_limit:
      type: integer
      description: maximum documents to return
query: |
  FOR doc IN Compounds
    SEARCH ANALYZER(PHRASE(doc.id, @search_text)
                 OR PHRASE(doc.name, @search_text)
                 OR PHRASE(doc.abbreviation, @search_text)
                 OR PHRASE(doc.aliases, @search_text), 'text_en') OR @all_documents
    FILTER @include_obsolete || doc.is_obsolete == 0
    SORT doc.id
    LIMIT @offset, @result_limit
    RETURN doc
